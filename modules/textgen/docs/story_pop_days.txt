/*!

\page page_story_pop_days Tarina "pop_days"

Tarina \c pop_days on muotoa

 -# "Sateen todennäköisyys on [viikonpäivänä] x%"
    -# ", [viikonpäivänä] huomattavasti suurempi."
    -# ", [viikonpäivänä] suurempi."
    -# ", [viikonpäivänä] hieman suurempi."
    -# ", [viikonpäivänä] sama."
    -# ", [viikonpäivänä] hieman pienempi."
    -# ", [viikonpäivänä] pienempi."
    -# ", [viikonpäivänä] huomattavasti pienempi."
 -# Poudan todennäköisyys on [viikonpäivänä] x%"

missä viimeistä muotoa käytetään, jos negatointioptio on päällä.

Ruotsiksi

 -# "Sannolikheten för nederbörd är [på veckodag] x%"
    -# ", [på veckodag] betydligt större."
    -# ", [på veckodag] större."
    -# ", [på veckodag] något större."
    -# ", [på veckodag] densamma."
    -# ", [på veckodag] något mindre."
    -# ", [på veckodag] mindre."
    -# ", [på veckodag] betydligt mindre."
 -# Sannolikheten för ingen nederbörd är [på veckodag] x%"
 

Englanniksi

 -# "Probability of precipitation is [on weekday] x%"
    -# ", [on weekday] significantly greater."
    -# ", [on weekday] greater."
    -# ", [on weekday] somewhat greater."
    -# ", [on weekday] the same."
    -# ", [on weekday] somewhat smaller."
    -# ", [on weekday] smaller."
    -# ", [on weekday] significantly smaller."
 -# "Probability of no precipitation is [on weekday] x%"

Tarina soveltuu yhden/kahden vuorokauden ennusteisiin. Sivulausetta ei
ole yhden vuorokauden ennusteissa. Kolmannesta tai sitä seuraavista päivistä
ei kerrota mitään.

Jos jonkin päivän sateen todennäköisyys alittaa tai ylittää asetetut
rajat, ei kyseisestä päivästä kerrota mitään. Jäljelle jää siis vain
joko tyhjä tarina, tai tarina muotoa "Sateen todennäköisyys on
[viikonpäivänä] X%."

Sateen todennäköisyys lasketaan seuraavasti:

 -# Lasketaan ajassa maksimi ja sitten alueellinen keskiarvo
 -# Lasketaan ajassa keskiarvo ja sitten alueellinen keskiarvo
 -# Lasketaan näiden lukujen keskiarvo

Kun puhutaan esimerkiksi tästä päivästä, vastaa ensimmäinen arvo
tulkintaa "Keskimääräinen todennäköisyys alueella, että jonain hetkenä
päivästä sataa." Toinen arvo vastaa tulkintaa "Keskimääräinen
todennäköisyys alueella, että minä tahansa hetkenä sataa."  Ihmisten
käsitys alueellisesta todennäköisyydestä luultavasti vaihtelee näiden
kahden tulkinnan välillä, joten niistä otetaan keskiarvo.

Se, onko kyseessä sateen todennäköisyys vain poudan todennäköisyys
selviää mahdollisen muuttujan
\code
textgen::[kappale]::story::pop_days::negate
\endcode
arvosta. Arvolla \c true, kyseessä on poudan todennäköisyys. Kaikissa
muissa tapauksissa kyseessä on sateen todennäköisyys.

Aikafraasit ovat tyyppiä \ref sec_periodifraasit_today ja
\ref sec_periodifraasit_next_day. Niihin liittyviä asetuksia
kontrolloidaan muuttujilla
\code
textgen::[kappale]::story::pop_days::today::phrases
textgen::[kappale]::story::pop_days::next_day::phrases
\endcode
Tyypillisiä asetuksia ovat esimerkiksi
\code
textgen::[kappale]::story::pop_days::next_day::phrases = followingday
\endcode

Päivän määritelmä saadaan muuttujista
\code
textgen::[kappale]::story::pop_days::day::starthour = [0-23]
textgen::[kappale]::story::pop_days::day::endhour = [0-23]
textgen::[kappale]::story::pop_days::day::maxstarthour = [0-23]
textgen::[kappale]::story::pop_days::day::minendhour = [0-23]
\endcode
Päivän normaali aikaväli on \c starthour - \c endhour. Jos periodi on
lyhyempi kuin mitä nämä asetukset vaativat, voidaan niissä joustaa
muuttujien \c maxstarthour - \c minendhour rajoissa. Joustorajan
puuttuessa ei joustoa sallita ollenkaan.

Oletusarvoisesti \c starthour = 0 ja \c endhour = 0. Joustorajat ovat
optionaalisia.

Sateen todennäköisyys pyöristetään tarkkuuteen
\code
textgen::[kappale]::story::pop_days::precision = [0-100]
\endcode
Sateen todennäköisyyden täytyy vähintään
\code
textgen::[kappale]::story::pop_days::minimum = [0-100] (default = 10)
\endcode
ennen kuin todennäköisyydestä kerrotaan, ja enintään
\code
textgen::[kappale]::story::pop_days::maximum = [0-100] (default = 100)
\endcode

Erotuksen suuruus päätellään seuraavista rajoista
\code
textgen::[kappale]::story::pop_days::comparison::significantly_greater = [0-100]
textgen::[kappale]::story::pop_days::comparison::greater = [0-100]
textgen::[kappale]::story::pop_days::comparison::somewhat_greater = [0-100]
textgen::[kappale]::story::pop_days::comparison::somewhat_smaller = [0-100]
textgen::[kappale]::story::pop_days::comparison::smaller = [0-100]
textgen::[kappale]::story::pop_days::comparison::significantly_smaller = [0-100]
\endcode
seuraavasti tuloksista \c pop2 ja \c pop1

 -# Jos \c pop2 - \c pop1 >= \c significantly_greater, valitaan "huomattavasti suurempi"
 -# Jos \c pop2 - \c pop1 >= \c greater, valitaan "suurempi"
 -# Jos \c pop2 - \c pop1 >= \c somewhat_greater, valitaan "hieman suurempi"
 -# Jos \c pop1 - \c pop2 >= \c significantly_smaller, valitaan "huomattavasti pienempi"
 -# Jos \c pop1 - \c pop2 >= \c smaller, valitaan "pienempi"
 -# Jos \c pop1 - \c pop2 >= \c somewhat_smaller, valitaan "hieman pienempi"
 -# Muuten valitaan "sama"

Tarvittavat fraasit ovat

 - "sateen todennäköisyys"
 - "poudan todennäköisyys"
 - "on"
 - "huomattavasti suurempi"
 - "suurempi"
 - "hieman suurempi"
 - "sama"
 - "hieman pienempi"
 - "pienempi" 
 - "huomattavasti pienempi"

Lisäksi tarvitaan periodifraasit \ref sec_periodifraasit_today ja
\ref sec_periodifraasit_next_day.

Tarinan laskennassa generoidut funktiot voi ylikuormittaa seuraavasti:
\code
textgen::[kappale]::story::pop_days::fake::day1::meanmax = [result]
textgen::[kappale]::story::pop_days::fake::day1::meanmean = [result]
textgen::[kappale]::story::pop_days::fake::day2::meanmax = [result]
textgen::[kappale]::story::pop_days::fake::day2::meanmean = [result]
\endcode

*/
